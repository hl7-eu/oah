# Script Suite Documentation

## Overview
This set of scripts automates a series of tasks to extract mappings from JSON files, generate corresponding PlantUML diagrams, and ultimately convert those diagrams into XHTML files with specific sections. The output can also include a YAML file for managing relationships.

### Components:
- **extract-map-csv.py**: Extracts mappings from JSON files and outputs a CSV file.
- **generate_diagrams.py**: Generates PlantUML diagrams based on the extracted mappings.
- **generate-xhtml.py**: Uses the PlantUML diagrams to create structured XHTML files.

## Pre-requisites
- **Python 3.x**: Ensure Python 3.x is installed and available in your PATH.
- **Python packages**:
  - Install required packages using:
    ```bash
    pip install pandas argparse shutil
    ```

## `config.py` Configuration
The scripts rely on a `config.py` file that specifies directories and files used during execution. Below is an example structure for the `config.py` file:

```python
# Directory containing the scripts
scripts_dir = '/path/to/scripts/'

# Directory containing input JSON files
directory_path = '/path/to/json/files/'

# Path to save the generated CSV
csv_file = '/path/to/output/csv_file.csv'

# Directory containing PlantUML files
puml_dir = '/path/to/puml/files/'

# Path to the XHTML template file
template_file_path = '/path/to/template.xhtml'

# Directory where generated XHTML files will be saved
xml_output_dir = '/path/to/output/xhtml/'
```

### Script Details

### 1. `extract-map-csv.py`

#### Purpose:
This script scans a directory for JSON files, extracts profile mappings, and generates a CSV file listing ConceptMap IDs and their source and target profiles.

#### Arguments:
- `-directory`: The directory containing the input JSON files.
- `-csv_file`: The path to save the generated CSV file.

#### Example Usage:
```bash
python extract-map-csv.py -directory /path/to/json/files -csv_file /path/to/output/csv_file.csv
```

#### Output:
- A CSV file containing extracted mappings.

### 2. `generate_diagrams.py`

#### Purpose:
This script reads the generated CSV file from the previous step and creates PlantUML diagrams. Each diagram visualizes the relationships between source and target profiles for each ConceptMap ID.

#### Arguments:
- `-csv_file`: The path to the CSV file generated by `extract-map-csv.py`.
- `-puml_dir`: The directory where the PlantUML diagrams will be saved.
- `-clean`: (Optional) If provided, the script will clean the PlantUML output directory before generating new diagrams.

#### Example Usage:
```bash
python generate_diagrams.py -csv_file /path/to/output/csv_file.csv -puml_dir /path/to/output/puml_dir -clean
```

#### Output:
- PlantUML files are generated in the specified directory.

### 3. `generate-xhtml.py`

#### Purpose:
This script uses an XHTML template to generate structured XHTML files. It includes sections for each profile and their corresponding PlantUML diagrams.

#### Arguments:
- `-template`: Path to the XHTML template file.
- `-puml_dir`: Directory containing the PlantUML files generated by the previous script.
- `-xml_output_dir`: Directory where the generated XHTML files will be saved.
- `-clean`: (Optional) If provided, the script will clean the XHTML output directory before generating new files.

#### Example Usage:
```bash
python generate-xhtml.py -template /path/to/template.xhtml -puml_dir /path/to/puml/dir -xml_output_dir /path/to/output/xhtml/ -clean
```

#### Output:
- XHTML files are generated for each profile and saved in the specified output directory.
- A YAML file (`puml-extract.yaml`) is also generated to manage relationships.

### Main Script: `run_all_scripts.py`

This script orchestrates the execution of all the scripts in sequence, ensuring that the output from one step is correctly passed to the next.

#### Arguments:
- `-config`: Path to the `config.py` file containing all necessary paths and settings.

#### Example Usage:
```bash
python run_all_scripts.py -config /path/to/config.py
```

#### Cleaning Option:
The `-clean` option can be used when running the script to ensure that output directories are cleaned before generating new files:

```bash
python run_all_scripts.py -config /path/to/config.py -clean
```

### Directory Structure:
- **Input Files**: JSON files should be located in the directory specified by `directory_path`.
- **CSV File**: The output CSV will be saved at the path specified by `csv_file`.
- **PlantUML Files**: PlantUML diagrams will be generated in the directory specified by `puml_dir`.
- **XHTML Files**: The XHTML output will be saved in the directory specified by `xml_output_dir`.

### Example Workflow:
1. Place all the JSON files in the specified `directory_path`.
2. Ensure the PlantUML files directory (`puml_dir`) and XHTML output directory (`xml_output_dir`) are empty or ready for new files.
3. Run `run_all_scripts.py` to execute the full workflow.

### Conclusion:
This suite of scripts automates the process of extracting mappings, generating visualizations, and compiling them into structured XHTML files. By following the outlined steps, you can ensure that the process runs smoothly from start to finish.